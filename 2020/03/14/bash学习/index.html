<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> bash学习 · noHotpot</title><meta name="description" content="bash学习 - Yc"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/nine.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://nohotpot.github.io/atom.xml" title="noHotpot"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="noHotpot" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/nine.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://instagram.com/no_hotpot" target="_blank" class="nav-list-link">INSTAGRAM</a></li><li class="nav-list-item"><a href="https://github.com/gitjohnhub" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://gitjohnhub.github.io" target="_blank" class="nav-list-link">网盘</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">bash学习</h1><div class="post-info">Mar 14, 2020</div><div class="post-content"><h1 id="特殊的变量"><a href="#特殊的变量" class="headerlink" title="特殊的变量"></a>特殊的变量</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">0 执行的文件名</span></span><br><span class="line"><span class="meta">$</span><span class="bash"><span class="comment"># 传递到脚本的参数个数</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">* 以<span class="string">"<span class="variable">$1</span> <span class="variable">$2</span> … <span class="variable">$n</span>"</span>的单一字符串形式输出所有参数</span></span><br><span class="line"><span class="meta">$</span><span class="bash">$ 脚本运行的当前进程ID号</span></span><br><span class="line"><span class="meta">$</span><span class="bash">! 后台运行的最后一个进程的ID号</span></span><br></pre></td></tr></table></figure>

<h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span>语句</span></span><br><span class="line">if condition1</span><br><span class="line">then</span><br><span class="line">    command1</span><br><span class="line">elif condition2 </span><br><span class="line">then </span><br><span class="line">    command2</span><br><span class="line">else</span><br><span class="line">    commandN</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span>经常和<span class="built_in">test</span>一起用</span></span><br><span class="line">if test $[num1] -eq $[num2]</span><br><span class="line">then</span><br><span class="line">    echo '两个数字相等!'</span><br><span class="line">else</span><br><span class="line">    echo '两个数字不相等!'</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span>循环</span></span><br><span class="line">for var in item1 item2 ... itemN</span><br><span class="line">do</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">while</span></span></span><br><span class="line">while condition</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> until</span></span><br><span class="line">until condition</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">case</span></span></span><br><span class="line">case 值 in</span><br><span class="line">模式1)</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line">模式2）</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>



<h1 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 定义</span></span><br><span class="line">array_name = (a b "c" d)</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;array_name[0]&#125;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取数组所有元素，以数组显示，可以用<span class="keyword">for</span>循环</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;my_array[@]&#125;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取数组所有元素，以字符串显示</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;my_array[*]&#125;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取数组长度</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#my_array[@]&#125;</span></span></span><br></pre></td></tr></table></figure>

<h1 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h1><blockquote>
<p>原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 awk 和 expr，expr 最常用</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">val=`expr 2 + 2`</span><br><span class="line">val=`expr $a \* $b`</span><br><span class="line">echo "两数运算结果为 : $val" </span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意空格</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 相等/不相等</span></span><br><span class="line">[ $a == $b ] </span><br><span class="line">[ $a != $b ] </span><br><span class="line">-eq	检测两个数是否相等，相等返回 true</span><br><span class="line">-ne	检测两个数是否不相等，不相等返回 true</span><br><span class="line">-gt	检测左边的数是否大于右边的，如果是，则返回 true</span><br><span class="line">-lt	检测左边的数是否小于右边的，如果是，则返回 true</span><br><span class="line">-ge	检测左边的数是否大于等于右边的，如果是，则返回 true</span><br><span class="line">-le	检测左边的数是否小于等于右边的，如果是，则返回 true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 与或非</span></span><br><span class="line">!	非运算，表达式为 true 则返回 false，否则返回 true</span><br><span class="line">-o	或运算，有一个表达式为 true 则返回 true</span><br><span class="line">-a	与运算，两个表达式都为 true 才返回 true</span><br><span class="line"></span><br><span class="line">&amp;&amp;	逻辑的 AND [[ $a -lt 100 &amp;&amp; $b -gt 100 ]] 返回 false</span><br><span class="line">||	逻辑的 OR</span><br><span class="line"></span><br><span class="line">-z	检测字符串长度是否为0，为0返回 true。	[ -z $a ] 返回 false。</span><br><span class="line">-n	检测字符串长度是否为0，不为0返回 true。	[ -n "$a" ] 返回 true。</span><br><span class="line"><span class="meta">$</span><span class="bash">	检测字符串是否为空，不为空返回 <span class="literal">true</span>。	[ <span class="variable">$a</span> ] 返回 <span class="literal">true</span>。</span></span><br></pre></td></tr></table></figure>

<h1 id="文件检测"><a href="#文件检测" class="headerlink" title="文件检测"></a>文件检测</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-b file	检测文件是否是块设备文件，如果是，则返回 true。	[ -b $file ] 返回 false。</span><br><span class="line">-c file	检测文件是否是字符设备文件，如果是，则返回 true。	[ -c $file ] 返回 false。</span><br><span class="line">-d file	检测文件是否是目录，如果是，则返回 true。	[ -d $file ] 返回 false。</span><br><span class="line">-f file	检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。	[ -f $file ] 返回 true。</span><br><span class="line">-g file	检测文件是否设置了 SGID 位，如果是，则返回 true。	[ -g $file ] 返回 false。</span><br><span class="line">-k file	检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。	[ -k $file ] 返回 false。</span><br><span class="line">-p file	检测文件是否是有名管道，如果是，则返回 true。	[ -p $file ] 返回 false。</span><br><span class="line">-u file	检测文件是否设置了 SUID 位，如果是，则返回 true。	[ -u $file ] 返回 false。</span><br><span class="line">-r file	检测文件是否可读，如果是，则返回 true。	[ -r $file ] 返回 true。</span><br><span class="line">-w file	检测文件是否可写，如果是，则返回 true。	[ -w $file ] 返回 true。</span><br><span class="line">-x file	检测文件是否可执行，如果是，则返回 true。	[ -x $file ] 返回 true。</span><br><span class="line">-s file	检测文件是否为空（文件大小是否大于0），不为空返回 true。	[ -s $file ] 返回 true。</span><br><span class="line">-e file	检测文件（包括目录）是否存在，如果是，则返回 true。	[ -e $file ] 返回 true。</span><br></pre></td></tr></table></figure>

<h1 id="标准输入输出"><a href="#标准输入输出" class="headerlink" title="标准输入输出"></a>标准输入输出</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">read</span> 命令从标准输入中读取一行,并把输入行的每个字段的值指定给 shell 变量</span></span><br><span class="line">read name</span><br><span class="line">echo $&#123;name&#125;</span><br><span class="line"></span><br><span class="line">printf "%-10s %-8s %-4s\n" 姓名 性别 体重kg </span><br><span class="line">printf "%-10s %-8s %-4.2f\n" 郭靖 男 66.1234</span><br><span class="line"><span class="meta">#</span><span class="bash"> -表示左对齐，没有表示右对齐</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 10表示宽度为10，不足补空格</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> .2f表示保留两个小数点</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">printf</span> 不自动换行</span></span><br><span class="line"></span><br><span class="line">printf "%s and %d \n" </span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果没有 arguments，那么 %s 用NULL代替，%d 用 0 代替</span></span><br></pre></td></tr></table></figure>



<h1 id="转义"><a href="#转义" class="headerlink" title="转义"></a>转义</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -e "OK! \n" # -e 开启转义</span><br><span class="line">echo -e "OK! \c" # -e 开启转义 \c 不换行</span><br><span class="line">echo "It is a test"</span><br></pre></td></tr></table></figure>

<h1 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在本机上生成key</span></span><br><span class="line">ssh-keygen</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制到远程主机</span></span><br><span class="line">ssh-copy-id user@server.ip</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下次无需密码即可直接登录主机</span></span><br><span class="line">ssh user@server.ip</span><br></pre></td></tr></table></figure>

<h1 id="SSH-CLIENT"><a href="#SSH-CLIENT" class="headerlink" title="SSH_CLIENT"></a>SSH_CLIENT</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;SSH_CLIENT&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 192.168.0.106 49740 22</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 检查ssh连接数</span></span><br><span class="line">ps -ef | grep -c "ssh"</span><br></pre></td></tr></table></figure>

<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">funWithReturn()&#123;</span><br><span class="line">    echo "这个函数会对输入的两个数字进行相加运算..."</span><br><span class="line">    echo "输入第一个数字: "</span><br><span class="line">    read aNum</span><br><span class="line">    echo "输入第二个数字: "</span><br><span class="line">    read anotherNum</span><br><span class="line">    echo "两个数字分别为 $aNum 和 $anotherNum !"</span><br><span class="line">    return $(($aNum+$anotherNum))</span><br><span class="line">&#125;</span><br><span class="line">funWithReturn</span><br><span class="line">echo "输入的两个数字之和为 $? "</span><br><span class="line"><span class="meta">#</span><span class="bash"> 函数返回值通过$?来调用</span></span><br></pre></td></tr></table></figure>

<h1 id="输入输出重定向"><a href="#输入输出重定向" class="headerlink" title="输入输出重定向"></a>输入输出重定向</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">command &gt; file	将输出重定向到 file。</span><br><span class="line">command &lt; file	将输入重定向到 file。</span><br><span class="line">command &gt;&gt; file	将输出以追加的方式重定向到 file。</span><br><span class="line">n &gt; file	将文件描述符为 n 的文件重定向到 file。</span><br><span class="line">n &gt;&gt; file	将文件描述符为 n 的文件以追加的方式重定向到 file。</span><br><span class="line">n &gt;&amp; m	将输出文件 m 和 n 合并。</span><br><span class="line">n &lt;&amp; m	将输入文件 m 和 n 合并。</span><br><span class="line">&lt;&lt; tag	将开始标记 tag 和结束标记 tag 之间的内容作为输入。</span><br><span class="line">需要注意的是文件描述符 0 通常是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）。</span><br><span class="line">/dev/null 是一个特殊的文件，写入到它的内容都会被丢弃</span><br></pre></td></tr></table></figure>

<h1 id="包含外部shell"><a href="#包含外部shell" class="headerlink" title="包含外部shell"></a>包含外部shell</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 两种方法均可</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 被包含的文件 filename 不需要可执行权限。</span></span><br><span class="line">source filename</span><br><span class="line">. filename</span><br></pre></td></tr></table></figure>

<h1 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk '&#123;[pattern] action&#125;' &#123;filenames&#125;</span><br></pre></td></tr></table></figure>

<h1 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 静默模式，不输出任何东西</span></span><br><span class="line">-s/--slient</span><br><span class="line"><span class="meta">#</span><span class="bash"> show error</span></span><br><span class="line">-S/--show-error</span><br><span class="line"><span class="meta">#</span><span class="bash"> post传输</span></span><br><span class="line">-d/--data</span><br><span class="line">curl -s -d "chat_id=$i&amp;text=$&#123;TEXT&#125;&amp;disable_web_page_preview=true&amp;parse_mode=markdown" $URL &gt; /dev/null</span><br></pre></td></tr></table></figure>

<h1 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 自定义分隔符，指定区域</span></span><br><span class="line">-d "," -f2</span><br><span class="line"><span class="meta">#</span></span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2020/03/14/%E7%BD%91%E7%9B%98%E7%9B%AE%E5%BD%95/" class="prev">PREV</a><a href="/2020/03/02/Website-collection/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'nohotpot';
var disqus_identifier = '2020/03/14/bash学习/';
var disqus_title = 'bash学习';
var disqus_url = 'https://nohotpot.github.io/2020/03/14/bash学习/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//nohotpot.disqus.com/count.js" async></script><div class="copyright"><p>© 2020 <a href="https://nohotpot.github.io">Yc</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>